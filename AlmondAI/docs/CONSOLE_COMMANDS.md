# AlmondAI Console Commands

> **Tip:** Commands can be prefixed with `/` (for slash-style shortcuts) or entered without it. Use a leading `\\` to force text to be treated as a prompt when it would otherwise look like a command. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1038-L1105】

| Command name | Usage syntax | Arguments | Function summary | Side effects |
| --- | --- | --- | --- | --- |
| `help` | `help` | None | Prints the built-in command reference that mirrors the table shown when the console starts. | Writes the help text to stdout only. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1083-L1108】 |
| `exit`, `quit` | `exit` \| `quit` | None | Terminates the interactive loop and shuts down the runtime cleanly. | Ends the console session; no files are modified. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1081-L1082】 |
| `generate` | `generate <prompt>` | `<prompt>` (required prompt text) | Sends the prompt through the active backend (local student or configured chat backend) and prints the response plus routing/usage metadata. | May trigger remote auto-training: if a chat backend is active and the response is allowed, the console calls `train.step`, which ingests the sample, appends it to `data/training_data.jsonl`, updates retrieval metadata, logs to `data/training_log.txt`, and runs a learner update. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L805-L1034】【F:AlmondAI/src/serve.cpp†L616-L689】【F:AlmondAI/src/train.cpp†L360-L446】【F:AlmondAI/src/train.cpp†L1159-L1181】 |
| `retrieve` | `retrieve <query>` | `<query>` (required search text) | Queries the retrieval index for stored samples that match the query and prints formatted hit information. | Reads from the retrieval index only; no persistent state is modified. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1606-L1691】【F:AlmondAI/src/serve.cpp†L773-L781】 |
| `directory`, `dir` | `directory [training]` | Optional `training` scope | Resolves and prints absolute paths for the main data directory and key training artefacts so you can inspect them on disk. | Performs filesystem existence checks and writes the paths to stdout without changing files. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1458-L1492】 |
| `train` | `train <file> [epochs=1] [batch=32]` | `<file>` (required JSONL path), `epochs`, `batch` (optional positive integers) | Streams supervised fine-tuning against the given dataset by invoking the `trainer.fit` MCP method (falling back to `train`). | Emits structured progress over MCP, updates learner weights, expands vocabulary, saves checkpoints, appends to `data/training_log.txt`, and persists accepted samples. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1897-L1958】【F:AlmondAI/src/serve.cpp†L1315-L1372】【F:AlmondAI/src/train.cpp†L360-L446】 |
| `auto`, `autopilot` | `auto [loops=1] [delay_ms=0] [limit=N] [tags=tag1,tag2]` | Optional loop count, delay, `limit=`, `tags=` filters | Runs a curated self-learning loop with shuffle + dedupe defaults, fetching teacher answers, training on approved samples, and summarising metrics. | Calls `train.self_loop`, which repeatedly queries the teacher, ingests and trains on approved replies, appends samples/logs, updates retrieval metadata, and prints summaries. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1694-L1783】【F:AlmondAI/src/serve.cpp†L989-L1287】【F:AlmondAI/src/train.cpp†L360-L446】 |
| `self-learn`, `selflearn` | `self-learn [loops=1] [delay_ms=0] [shuffle|ordered] [force|dedupe] [limit=N] [tags=tag1,tag2]` | Optional loop count, delay, ordering mode, duplication policy, limit, and tag filters | Advanced self-learning loop with manual control over shuffle/force semantics before calling into the same training service as `auto`. | Same as `auto`: invokes `train.self_loop` with the provided options, updating datasets, retrieval metadata, logs, and learner weights. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1786-L1893】【F:AlmondAI/src/serve.cpp†L989-L1287】【F:AlmondAI/src/train.cpp†L360-L446】 |
| `hot-swap` | `hot-swap [name]` | Optional adapter `name` | Promotes the named adapter to the active stack or rolls back to the previous adapter when no name is supplied. | Calls `admin.hot_swap`/`hot-swap`, which promote or roll back adapters within the learner; emits a status message only. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1961-L1996】【F:AlmondAI/src/serve.cpp†L799-L814】 |
| `chat use` | `chat use <kind> [endpoint] [model] [key]` | `<kind>` (required backend), optional endpoint/model/key | Configures an external chat backend (e.g., `lmstudio`, OpenAI-compatible providers) and optionally enables remote auto-training. | Rebuilds the chat client, updates routing, and toggles remote auto-training; later `generate` calls may hit the remote backend and train via `train.step`. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1500-L1574】【F:AlmondAI/src/serve.cpp†L616-L689】 |
| `chat clear` | `chat clear` | None | Disables any active chat backend and returns to local-only inference. | Releases the remote backend handle, stops remote auto-training, and writes a confirmation message. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1576-L1594】 |
| `history` | `history [clear]` | Optional `clear` | Shows the recorded conversation log with routes, usage metrics, and notes, or clears it when `clear` is provided. | Maintains an in-memory log only; `clear` resets the vector and turn counter without touching files. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1414-L1455】 |
| Escaped prompt | `\\<text>` | `<text>` (required prompt) | Forces the console to treat the input as a prompt even if it begins with `/`, bypassing command parsing. | Delegates directly to `generate` handling; effects mirror a normal prompt submission. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1038-L1105】【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1598-L1603】 |

**Which commands train the model?** `generate` (when auto-training conditions are met), `train`, `auto`/`autopilot`, and `self-learn`/`selflearn` call into learner training paths that update weights, append to `data/training_data.jsonl`, refresh retrieval metadata, and log metrics. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L805-L1034】【F:AlmondAI/src/serve.cpp†L616-L689】【F:AlmondAI/src/serve.cpp†L989-L1287】【F:AlmondAI/src/train.cpp†L360-L446】【F:AlmondAI/src/train.cpp†L1159-L1181】

**Retrieval-only commands:** `retrieve` queries the retrieval index without changing state. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1606-L1691】【F:AlmondAI/src/serve.cpp†L773-L781】

**External chat integration:** `chat use` selects a remote backend and `chat clear` disables it; once active, `generate` forwards prompts remotely and may auto-train on teacher replies. 【F:AlmondShell/examples/AlmondAIRuntime/main.cpp†L1500-L1594】【F:AlmondAI/src/serve.cpp†L616-L689】
